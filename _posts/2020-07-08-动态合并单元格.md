---
title: antd 动态合并单元格
categories:
tags:
---

<!-- more -->

### 示例数据：
```
const listData = [
    {
        'name':'超时错误',
        'type': 'net',
        'pv':'20%',
        'uv':'20000'
    },
    {
        'name':'超时错误',
        'type': 'net',
        'pv':'10%',
        'uv':'10000'
    },
    {
        'name':'xx错误',
        'type': '4g',
        'pv':'10%',
        'uv':'10000'
    }
]
```
### 示例结果
![Image text](/assets/images/table.png)

error_type 是需要合并的字段,将具有相同name值的元素合并为一个数组,然后将数组展开为符合antd Table渲染条件的新数组
解决方案: 合并处理data

```
let formateData = (data, attr) => {
    return data.reduce((result, item) => {
        if (result.indexOf(item[attr]) < 0) {
            result.push(item[attr])
        }
        return result
    }, []).reduce((result, attr) => {
        //将name相同的数据作为新数组取出，并在其内部添加新字段**rowSpan**
        const children = data.filter(item => item.name === name);
        result = result.concat(
            children.map((item, index) => ({
                ...item,
                rowSpan: index === 0 ? children.length : 0
                //将第一行数据添加rowSpan字段
            }))
        )
        return result;
    }, [])
}
```
